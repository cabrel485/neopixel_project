#!/bin/sh
# Expected to be called as: depmodwrapper -a KERNEL_VERSION
if [ "$1" != "-a" -o "$2" != "-b" ]; then
    echo "Usage: depmodwrapper -a -b rootfs KERNEL_VERSION" >&2
    exit 1
fi

kernelabi=""
if [ -r "/home/wilson/Documents/Project/my_w2812b_Project/W2812bDesignIP_INTEGRATED/W2812bDesignIP_INTEGRATED.sdk/w2812b-zedboard/build/tmp/pkgdata/plnx-zynq7/kernel-depmod/kernel-abiversion" ]; then
    kernelabi=$(cat "/home/wilson/Documents/Project/my_w2812b_Project/W2812bDesignIP_INTEGRATED/W2812bDesignIP_INTEGRATED.sdk/w2812b-zedboard/build/tmp/pkgdata/plnx-zynq7/kernel-depmod/kernel-abiversion")
fi

if [ ! -r /home/wilson/Documents/Project/my_w2812b_Project/W2812bDesignIP_INTEGRATED/W2812bDesignIP_INTEGRATED.sdk/w2812b-zedboard/build/tmp/pkgdata/plnx-zynq7/kernel-depmod/System.map-$4 ] || [ "$kernelabi" != "$4" ]; then
    echo "Unable to read: /home/wilson/Documents/Project/my_w2812b_Project/W2812bDesignIP_INTEGRATED/W2812bDesignIP_INTEGRATED.sdk/w2812b-zedboard/build/tmp/pkgdata/plnx-zynq7/kernel-depmod/System.map-$4" >&2
    exec env depmod "$1" "$2" "$3" "$4"
else
    exec env depmod "$1" "$2" "$3" -F "/home/wilson/Documents/Project/my_w2812b_Project/W2812bDesignIP_INTEGRATED/W2812bDesignIP_INTEGRATED.sdk/w2812b-zedboard/build/tmp/pkgdata/plnx-zynq7/kernel-depmod/System.map-$4" "$4"
fi
